{"version":3,"file":"events.js","sourceRoot":"","sources":["../../src/types/events.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n    ControlAction,\r\n    WebcastChatMessage,\r\n    WebcastControlMessage,\r\n    WebcastEmoteChatMessage,\r\n    WebcastEnvelopeMessage,\r\n    WebcastGiftMessage,\r\n    WebcastLikeMessage,\r\n    WebcastLinkMicArmies,\r\n    WebcastLinkMicBattle,\r\n    WebcastLiveIntroMessage,\r\n    WebcastMemberMessage,\r\n    WebcastQuestionNewMessage,\r\n    WebcastRoomUserSeqMessage,\r\n    WebcastSocialMessage,\r\n    WebcastSubNotifyMessage\r\n} from '@/types//tiktok-schema';\r\nimport { RoomGiftInfo, RoomInfo, WebcastEventMessage, WebcastMessage } from '@/types/client';\r\nimport TikTokWsClient from '@/lib/ws/lib/ws-client';\r\n\r\nexport enum ControlEvent {\r\n    CONNECTED = 'connected',\r\n    DISCONNECTED = 'disconnected',\r\n    ERROR = 'error',\r\n    RAW_DATA = 'rawData',\r\n    DECODED_DATA = 'decodedData',\r\n    WEBSOCKET_CONNECTED = 'websocketConnected',\r\n    WEBSOCKET_DATA = 'websocketData',\r\n}\r\n\r\n\r\nexport enum WebcastEvent {\r\n    // Old Events - Added 1.X.X\r\n    CHAT = 'chat',\r\n    MEMBER = 'member',\r\n    GIFT = 'gift',\r\n    ROOM_USER = 'roomUser',\r\n    SOCIAL = 'social',\r\n    LIKE = 'like',\r\n    QUESTION_NEW = 'questionNew',\r\n    LINK_MIC_BATTLE = 'linkMicBattle',\r\n    LINK_MIC_ARMIES = 'linkMicArmies',\r\n    LIVE_INTRO = 'liveIntro',\r\n    EMOTE = 'emote',\r\n    ENVELOPE = 'envelope',\r\n    SUBSCRIBE = 'subscribe',\r\n    FOLLOW = 'follow',\r\n    SHARE = 'share',\r\n    STREAM_END = 'streamEnd',\r\n    CONTROL_MESSAGE = 'controlMessage',\r\n    BARRAGE = 'barrage',\r\n\r\n    // New Events - Added 2.0.4\r\n    HOURLY_RANK = 'hourlyRank',\r\n    GOAL_UPDATE = 'goalUpdate',\r\n    ROOM_MESSAGE = 'roomMessage',\r\n    CAPTION_MESSAGE = 'captionMessage',\r\n    IM_DELETE = 'imDelete',\r\n    IN_ROOM_BANNER = 'inRoomBanner',\r\n    RANK_UPDATE = 'rankUpdate',\r\n    POLL_MESSAGE = 'pollMessage',\r\n    RANK_TEXT = 'rankText',\r\n    LINK_MIC_BATTLE_PUNISH_FINISH = 'linkMicBattlePunishFinish',\r\n    LINK_MIC_BATTLE_TASK = 'linkMicBattleTask',\r\n    LINK_MIC_FAN_TICKET_METHOD = 'linkMicFanTicketMethod',\r\n    LINK_MIC_METHOD = 'linkMicMethod',\r\n    UNAUTHORIZED_MEMBER = 'unauthorizedMember',\r\n    OEC_LIVE_SHOPPING = 'oecLiveShopping',\r\n    MSG_DETECT = 'msgDetect',\r\n    LINK_MESSAGE = 'linkMessage',\r\n    ROOM_VERIFY = 'roomVerify',\r\n    LINK_LAYER = 'linkLayer',\r\n    ROOM_PIN = 'roomPin',\r\n}\r\n\r\n\r\nexport enum ConnectState {\r\n    DISCONNECTED = 'DISCONNECTED',\r\n    CONNECTING = 'CONNECTING',\r\n    CONNECTED = 'CONNECTED'\r\n}\r\n\r\nexport type EventHandler<T> = (event: T) => void | Promise<void>;\r\n\r\nexport type ClientEventMap = {\r\n\r\n    // Custom Events\r\n    [WebcastEvent.FOLLOW]: EventHandler<WebcastSocialMessage>,\r\n    [WebcastEvent.SHARE]: EventHandler<WebcastSocialMessage>,\r\n    [WebcastEvent.STREAM_END]: (event: { action: ControlAction }) => void | Promise<void>,\r\n\r\n    // Control Events\r\n    [ControlEvent.CONNECTED]: EventHandler<TikTokLiveConnectionState>,\r\n    [ControlEvent.DISCONNECTED]: EventHandler<void>,\r\n    [ControlEvent.ERROR]: EventHandler<any>,\r\n    [ControlEvent.WEBSOCKET_DATA]: EventHandler<Uint8Array>,\r\n    [ControlEvent.RAW_DATA]: (type: string, data: Uint8Array) => void | Promise<void>,\r\n    [ControlEvent.DECODED_DATA]: (type: string, event: any, binary: Uint8Array) => void | Promise<void>,\r\n    [ControlEvent.WEBSOCKET_CONNECTED]: EventHandler<TikTokWsClient>,\r\n\r\n    // Old Message Events - Added 1.X.X\r\n    [WebcastEvent.CHAT]: EventHandler<WebcastChatMessage>,\r\n    [WebcastEvent.MEMBER]: EventHandler<WebcastMemberMessage>,\r\n    [WebcastEvent.GIFT]: EventHandler<WebcastGiftMessage>,\r\n    [WebcastEvent.ROOM_USER]: EventHandler<WebcastRoomUserSeqMessage>,\r\n    [WebcastEvent.SOCIAL]: EventHandler<WebcastSocialMessage>,\r\n    [WebcastEvent.LIKE]: EventHandler<WebcastLikeMessage>,\r\n    [WebcastEvent.QUESTION_NEW]: EventHandler<WebcastQuestionNewMessage>,\r\n    [WebcastEvent.LINK_MIC_BATTLE]: EventHandler<WebcastLinkMicBattle>,\r\n    [WebcastEvent.LINK_MIC_ARMIES]: EventHandler<WebcastLinkMicArmies>,\r\n    [WebcastEvent.LIVE_INTRO]: EventHandler<WebcastLiveIntroMessage>,\r\n    [WebcastEvent.EMOTE]: EventHandler<WebcastEmoteChatMessage>,\r\n    [WebcastEvent.ENVELOPE]: EventHandler<WebcastEnvelopeMessage>,\r\n    [WebcastEvent.SUBSCRIBE]: EventHandler<WebcastSubNotifyMessage>,\r\n    [WebcastEvent.CONTROL_MESSAGE]: EventHandler<WebcastControlMessage>,\r\n    [WebcastEvent.BARRAGE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.HOURLY_RANK]: EventHandler<WebcastMessage>,\r\n\r\n    // New Message Events - Added 2.0.4\r\n    [WebcastEvent.GOAL_UPDATE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.ROOM_MESSAGE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.CAPTION_MESSAGE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.IM_DELETE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.IN_ROOM_BANNER]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.RANK_UPDATE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.POLL_MESSAGE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.RANK_TEXT]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_MIC_BATTLE_PUNISH_FINISH]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_MIC_BATTLE_TASK]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_MIC_FAN_TICKET_METHOD]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_MIC_METHOD]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.UNAUTHORIZED_MEMBER]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.OEC_LIVE_SHOPPING]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.MSG_DETECT]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_MESSAGE]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.ROOM_VERIFY]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.LINK_LAYER]: EventHandler<WebcastMessage>,\r\n    [WebcastEvent.ROOM_PIN]: EventHandler<WebcastMessage>,\r\n};\r\n\r\nexport const WebcastEventMap: Record<BasicWebcastEventMessage, keyof ClientEventMap> = {\r\n\r\n    // Old Events - Added 1.X.X\r\n    'WebcastChatMessage': WebcastEvent.CHAT,\r\n    'WebcastMemberMessage': WebcastEvent.MEMBER,\r\n    'WebcastRoomUserSeqMessage': WebcastEvent.ROOM_USER,\r\n    'WebcastSocialMessage': WebcastEvent.SOCIAL,\r\n    'WebcastLikeMessage': WebcastEvent.LIKE,\r\n    'WebcastQuestionNewMessage': WebcastEvent.QUESTION_NEW,\r\n    'WebcastLinkMicBattle': WebcastEvent.LINK_MIC_BATTLE,\r\n    'WebcastLinkMicArmies': WebcastEvent.LINK_MIC_ARMIES,\r\n    'WebcastLiveIntroMessage': WebcastEvent.LIVE_INTRO,\r\n    'WebcastEmoteChatMessage': WebcastEvent.EMOTE,\r\n    'WebcastEnvelopeMessage': WebcastEvent.ENVELOPE,\r\n    'WebcastSubNotifyMessage': WebcastEvent.SUBSCRIBE,\r\n    'WebcastBarrageMessage': WebcastEvent.BARRAGE,\r\n\r\n    // New Events - Added 2.0.4\r\n    'WebcastHourlyRankMessage': WebcastEvent.HOURLY_RANK,\r\n    'WebcastGoalUpdateMessage': WebcastEvent.GOAL_UPDATE,\r\n    'WebcastRoomMessage': WebcastEvent.ROOM_MESSAGE,\r\n    'WebcastCaptionMessage': WebcastEvent.CAPTION_MESSAGE,\r\n    'WebcastControlMessage': WebcastEvent.CONTROL_MESSAGE,\r\n    'WebcastImDeleteMessage': WebcastEvent.IM_DELETE,\r\n    'WebcastInRoomBannerMessage': WebcastEvent.IN_ROOM_BANNER,\r\n    'WebcastRankUpdateMessage': WebcastEvent.RANK_UPDATE,\r\n    'WebcastPollMessage': WebcastEvent.POLL_MESSAGE,\r\n    'WebcastRankTextMessage': WebcastEvent.RANK_TEXT,\r\n    'WebcastLinkMicBattlePunishFinish': WebcastEvent.LINK_MIC_BATTLE_PUNISH_FINISH,\r\n    'WebcastLinkmicBattleTaskMessage': WebcastEvent.LINK_MIC_BATTLE_TASK,\r\n    'WebcastLinkMicFanTicketMethod': WebcastEvent.LINK_MIC_FAN_TICKET_METHOD,\r\n    'WebcastLinkMicMethod': WebcastEvent.LINK_MIC_METHOD,\r\n    'WebcastUnauthorizedMemberMessage': WebcastEvent.UNAUTHORIZED_MEMBER,\r\n    'WebcastOecLiveShoppingMessage': WebcastEvent.OEC_LIVE_SHOPPING,\r\n    'WebcastMsgDetectMessage': WebcastEvent.MSG_DETECT,\r\n    'WebcastLinkMessage': WebcastEvent.LINK_MESSAGE,\r\n    'RoomVerifyMessage': WebcastEvent.ROOM_VERIFY,\r\n    'WebcastLinkLayerMessage': WebcastEvent.LINK_LAYER,\r\n    'WebcastRoomPinMessage': WebcastEvent.ROOM_PIN\r\n};\r\n\r\n\r\nexport type BasicWebcastEventMessage = keyof Omit<\r\n    WebcastEventMessage,\r\n    'WebcastGiftMessage'\r\n>;\r\n\r\n\r\nexport type TikTokLiveConnectionState = {\r\n    isConnected: boolean,\r\n    roomId: string,\r\n    roomInfo: RoomInfo | null,\r\n    availableGifts: RoomGiftInfo | null\r\n};\r\n"]}