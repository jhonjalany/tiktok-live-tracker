{"version":3,"file":"send-room-chat-euler.js","sourceRoot":"","sources":["../../../../src/lib/web/routes/send-room-chat-euler.ts"],"names":[],"mappings":";;;AAAA,yCAAsC;AAGtC,mCAA0F;AAI1F,MAAa,0BAA2B,SAAQ,aAAsE;IAElH,KAAK,CAAC,IAAI,CACN,EACI,MAAM,EACN,OAAO,EACP,SAAS,EACT,WAAW,EACX,OAAO,EACwB;QAGnC,MAAM,iBAAiB,GAAG,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC;QAC1E,MAAM,mBAAmB,GAAG,WAAW,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC;QAEhF,IAAI,iBAAiB,IAAI,CAAC,mBAAmB,EAAE;YAC3C,MAAM,IAAI,kDAA0C,CAChD,qDAAqD,CACxD,CAAC;SACL;QAED,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC;YAClE,MAAM;YACN,OAAO;YACP,SAAS,EAAE,iBAAiB;YAC5B,WAAW,EAAE,mBAAmB;SACnC,EACD,OAAO,CACV,CAAC;QAEF,QAAQ,aAAa,CAAC,MAAM,EAAE;YAC1B,KAAK,GAAG,CAAC;YACT,KAAK,GAAG;gBACJ,MAAM,IAAI,2BAAmB,CACzB,qFAAqF,EACrF,aAAa,CAAC,IAAI,CAAC,OAAO,EAC1B,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,CACrC,CAAC;YACN,KAAK,GAAG;gBACJ,OAAO,aAAa,CAAC,IAAI,CAAC;YAC9B;gBACI,MAAM,IAAI,KAAK,CAAC,wBAAwB,aAAa,EAAE,IAAI,EAAE,OAAO,IAAI,eAAe,EAAE,CAAC,CAAC;SAClG;IAEL,CAAC;CAEJ;AA9CD,gEA8CC","sourcesContent":["import { Route } from '@/types/route';\r\nimport { IWebcastRoomChatPayload, IWebcastRoomChatRouteResponse } from '@eulerstream/euler-api-sdk';\r\nimport { AxiosRequestConfig } from 'axios';\r\nimport { FetchSignedWebSocketIdentityParameterError, PremiumFeatureError } from '@/types';\r\n\r\nexport type SendRoomChatFromEulerRouteParams = IWebcastRoomChatPayload & { options?: AxiosRequestConfig };\r\n\r\nexport class SendRoomChatFromEulerRoute extends Route<SendRoomChatFromEulerRouteParams, IWebcastRoomChatRouteResponse> {\r\n\r\n    async call(\r\n        {\r\n            roomId,\r\n            content,\r\n            sessionId,\r\n            ttTargetIdc,\r\n            options\r\n        }: SendRoomChatFromEulerRouteParams\r\n    ): Promise<IWebcastRoomChatRouteResponse> {\r\n\r\n        const resolvedSessionId = sessionId || this.webClient.cookieJar.sessionId;\r\n        const resolvedTtTargetIdc = ttTargetIdc || this.webClient.cookieJar.ttTargetIdc;\r\n\r\n        if (resolvedSessionId && !resolvedTtTargetIdc) {\r\n            throw new FetchSignedWebSocketIdentityParameterError(\r\n                'ttTargetIdc must be set when sessionId is provided.'\r\n            );\r\n        }\r\n\r\n        const fetchResponse = await this.webClient.webSigner.webcast.sendRoomChat({\r\n                roomId,\r\n                content,\r\n                sessionId: resolvedSessionId,\r\n                ttTargetIdc: resolvedTtTargetIdc\r\n            },\r\n            options\r\n        );\r\n\r\n        switch (fetchResponse.status) {\r\n            case 401:\r\n            case 403:\r\n                throw new PremiumFeatureError(\r\n                    'Sending chats requires an API key & a paid plan, as it uses cloud managed services.',\r\n                    fetchResponse.data.message,\r\n                    JSON.stringify(fetchResponse.data)\r\n                );\r\n            case 200:\r\n                return fetchResponse.data;\r\n            default:\r\n                throw new Error(`Failed to send chat: ${fetchResponse?.data?.message || 'Unknown error'}`);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n"]}